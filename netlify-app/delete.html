<!DOCTYPE html>
<html lang="pl"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Świat Smartfonów - Usuń zdjęcia</title>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Plus+Jakarta+Sans%3Awght%40400%3B500%3B700%3B800" onload="this.rel='stylesheet'" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style type="text/tailwindcss">
    :root {
      --primary-color: #141414;
      --secondary-color: #007AFF;
      --background-color: #F9F9F9;
      --text-primary: #1C1C1E;
      --text-secondary: #636366;
      --accent-color: #E5E5EA;
    }
    body {
      font-family: 'Plus Jakarta Sans', 'Noto Sans', sans-serif;
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-[var(--background-color)] text-[var(--text-primary)]">
<div class="relative flex size-full min-h-screen flex-col justify-between overflow-x-hidden">
<header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md shadow-sm">
<div class="container mx-auto flex items-center justify-between p-4">
<a class="flex items-center gap-2 text-xl font-bold" href="#">
<svg class="text-[var(--secondary-color)]" fill="none" height="28" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="28" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
<span class="text-xl font-black">Świat Smartfonów</span>
</a>
<div class="relative group">
<button class="p-2">
<svg fill="none" height="28" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="28" xmlns="http://www.w3.org/2000/svg"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg>
</button>
<div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden group-hover:block">
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" href="lista.html">Lista zdjęć</a>
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" href="add.html">Dodaj zdjęcie</a>
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" href="delete.html">Usuń zdjęcia</a>
</div>
</div>
</div>
</header>
<main class="flex-1">
<div class="container mx-auto p-4 md:p-6">
<div class="bg-white rounded-2xl shadow-sm p-6">
<h2 class="text-2xl font-bold tracking-tight text-[var(--text-primary)] mb-6">
              Wybierz zdjęcia do usunięcia
            </h2>
<div id="imageGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-6">
<!-- Images will be loaded here dynamically -->
</div>
<div id="loading" class="text-center py-8">
<div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--secondary-color)]"></div>
<p class="mt-2 text-[var(--text-secondary)]">Ładowanie zdjęć...</p>
</div>
<div class="flex justify-between items-center pt-4 border-t">
<p id="selectedCount" class="text-[var(--text-secondary)]">Wybrano: 0 zdjęć</p>
<button id="deleteBtn" class="inline-flex items-center justify-center rounded-full bg-red-500 px-8 py-3 text-base font-bold text-white shadow-lg transition-transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                Usuń wybrane zdjęcia
              </button>
</div>
</div>
</div>
</main>
<footer class="bg-[var(--primary-color)] text-white/80 py-6 text-center">
<div class="container mx-auto px-4">
<nav class="grid grid-cols-3 gap-4 mb-4">
<a class="flex flex-col items-center justify-center gap-1 rounded-lg py-2 text-white/60 hover:text-white transition-colors" href="add.html">
<svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>
<span class="text-xs font-medium">Dodaj</span>
</a>
<a class="flex flex-col items-center justify-center gap-1 rounded-lg py-2 text-white/60 hover:text-white transition-colors" href="lista.html">
<svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path></svg>
<span class="text-xs font-medium">Lista</span>
</a>
<a class="flex flex-col items-center justify-center gap-1 rounded-lg py-2 text-[var(--secondary-color)] hover:text-white transition-colors" href="delete.html">
<svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg>
<span class="text-xs font-medium">Usuń</span>
</a>
</nav>
<p class="text-sm">© 2024 Świat Smartfonów. Panel zarządzania.</p>
</div>
</footer>
</div>

<script>
let selectedImages = new Set();
let allImages = [];

// Load images from API
async function loadImages() {
    try {
        const response = await fetch('/.netlify/functions/images');
        allImages = await response.json();
        
        const imageGrid = document.getElementById('imageGrid');
        const loading = document.getElementById('loading');
        
        loading.style.display = 'none';
        
        if (allImages.length === 0) {
            imageGrid.innerHTML = '<div class="col-span-full text-center py-8 text-[var(--text-secondary)]">Brak zdjęć do wyświetlenia</div>';
            return;
        }
        
        imageGrid.innerHTML = allImages.map(image => {
            const imageUrl = image.urls?.small || image.urls?.medium || image.urls?.original;
            const fileName = imageUrl ? imageUrl.split('/').pop() : 'Unknown';
            const date = new Date(image.created_at).toLocaleDateString('pl-PL');
            
            return `
                <div class="group relative flex flex-col gap-2 cursor-pointer" data-image-id="${image.id}">
                    <div class="relative w-full aspect-square">
                        <div class="absolute inset-0 bg-center bg-no-repeat bg-cover rounded-lg transition-transform duration-300" style="background-image: url('${imageUrl}');"></div>
                        <div class="absolute top-2 right-2">
                            <input type="checkbox" class="image-checkbox w-5 h-5 text-[var(--secondary-color)] bg-white border-2 border-gray-300 rounded focus:ring-[var(--secondary-color)] focus:ring-2" data-image-id="${image.id}">
                        </div>
                        <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-lg"></div>
                    </div>
                    <div>
                        <p class="text-text-primary text-sm font-medium leading-normal truncate">${fileName}</p>
                        <p class="text-text-secondary text-xs font-normal leading-normal">${date}</p>
                    </div>
                </div>
            `;
        }).join('');
        
        // Add event listeners to checkboxes
        document.querySelectorAll('.image-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', handleCheckboxChange);
        });
        
    } catch (error) {
        console.error('Error loading images:', error);
        document.getElementById('loading').innerHTML = '<p class="text-red-500">Błąd podczas ładowania zdjęć</p>';
    }
}

function handleCheckboxChange(e) {
    const imageId = parseInt(e.target.dataset.imageId);
    
    if (e.target.checked) {
        selectedImages.add(imageId);
    } else {
        selectedImages.delete(imageId);
    }
    
    updateUI();
}

function updateUI() {
    const selectedCount = document.getElementById('selectedCount');
    const deleteBtn = document.getElementById('deleteBtn');
    
    selectedCount.textContent = `Wybrano: ${selectedImages.size} zdjęć`;
    deleteBtn.disabled = selectedImages.size === 0;
}

async function deleteSelectedImages() {
    if (selectedImages.size === 0) return;
    
    if (!confirm(`Czy na pewno chcesz usunąć ${selectedImages.size} zdjęć? Ta operacja jest nieodwracalna.`)) {
        return;
    }
    
    const deleteBtn = document.getElementById('deleteBtn');
    deleteBtn.textContent = 'Usuwanie...';
    deleteBtn.disabled = true;
    
    try {
        for (const imageId of selectedImages) {
            await fetch(`/.netlify/functions/images?id=${imageId}`, {
                method: 'DELETE'
            });
        }
        
        alert('Zdjęcia zostały usunięte pomyślnie!');
        selectedImages.clear();
        loadImages(); // Reload the images
        
    } catch (error) {
        alert('Wystąpił błąd podczas usuwania zdjęć');
        console.error(error);
    } finally {
        deleteBtn.textContent = 'Usuń wybrane zdjęcia';
        updateUI();
    }
}

// Event listeners
document.getElementById('deleteBtn').addEventListener('click', deleteSelectedImages);

// Load images when page loads
document.addEventListener('DOMContentLoaded', loadImages);
</script>

</body></html>